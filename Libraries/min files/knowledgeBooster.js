const dataApi="../pdfData.json";let pdfData;if(localStorage.getItem("pdfData")){pdfData=JSON.parse(localStorage.getItem("pdfData")),console.log("Loaded data from local storage:",pdfData);let e=Object.keys(pdfData).length;console.log(`Total number of entries: ${e}`),populateCards()}else fetch("../pdfData.json").then(e=>{if(!e.ok)throw Error("Network response was not ok");return e.json()}).then(e=>{pdfData=e.pdfFilesData,console.log("Fetched Data:",pdfData),Object.keys(pdfData).length,localStorage.setItem("pdfData",JSON.stringify(pdfData)),populateCards()}).catch(e=>console.error("Error fetching data:",e));function clearLocalStorageData(){localStorage.removeItem("pdfData"),console.log("Local storage cleared")}function imageLoadOnCategory(){let e=document.querySelectorAll(".card"),t={html:"../Assets/images/html-css.jpg",javascript:"../Assets/images/javascript.jpeg",react:"../Assets/images/react.png",dsa:"../Assets/images/dsa.jpeg",sql:"../Assets/images/sql.png",python:"../Assets/images/python.png",mongodb:"../Assets/images/mongodb.jpeg",git:"../Assets/images/Git&Github.png",sysdesign:"../Assets/images/system design.jfif",testing:"../Assets/images/testing.png",Nodejs:"../Assets/images/node-js.webp",angular:"../Assets/images/angularjs.png",docker:"../Assets/images/docker.png"};e.forEach(e=>{let a=e.getAttribute("data-category"),n=e.querySelector("img.lazy-load");if(t[a]){let l=t[a];n.setAttribute("data-src",l)}})}function shuffleCards(){let e=document.getElementById("cardContainer"),t=Array.from(e.children);for(let a=t.length-1;a>0;a--){let n=Math.floor(Math.random()*(a+1));[t[a],t[n]]=[t[n],t[a]]}t.forEach(t=>e.appendChild(t))}function createCard(e,{title:t,description:a,category:n}){let l=document.createElement("div");return l.classList.add("card"),l.setAttribute("data-id",e),l.setAttribute("data-category",n),l.innerHTML=`
    <div class="card-image-wrapper">
     <img src="" data-src="../Assets/images/${n}.jpg" class="lazy-load" alt="${t}">
     </div>
     <div class="content">
         <h2 class="card-h2">${t}</h2>
         <p class="card-p">${a}</p>
         <div class="card-btn-container">
         <button class="view-btn"> <i class="fa-regular fa-eye"></i> View PDF</button>
         <button class="Download-pdf-btn">Download <i class="fa-solid fa-download"></i></button>
         </div>  
           <div class="like-container">
           <button role="button">
           <i class="fa fa-heart like-btn" aria-hidden="true"></i></button>
     </div>
     </div>
 `,l}function populateCards(){if(!pdfData||"object"!=typeof pdfData){console.error("pdfData is undefined, null, or not an object!");return}let e=document.getElementById("cardContainer");if(!e){console.error("Card container not found!");return}e.innerHTML="",Object.entries(pdfData).forEach(([t,a])=>{let n=createCard(t,a),l=n.querySelector(".view-btn"),s=n.querySelector(".Download-pdf-btn");l&&l.addEventListener("click",e=>{e.stopPropagation(),openPDF(t)}),s&&s.addEventListener("click",e=>{e.stopPropagation(),downloadPDfUrl(t)}),e.appendChild(n)}),console.log("Cards populated successfully."),shuffleCards(),lazyLoadInstance(),imageLoadOnCategory(),filterCards()}function openPDF(e){let t=pdfData[e]?.url,a=document.getElementById("pdfIframe"),n=document.getElementById("pdfOverlay"),l=document.body;if(t&&a&&n){console.log("Setting iframe src to:",t),a.src=t,n.style.display="flex",l.style.overflow="hidden",console.log(t);let s=new URLSearchParams(window.location.search);s.set("pdf",e);let o=`${window.location.origin}${window.location.pathname}?${s.toString()}`;window.history.pushState({path:o},"",o),console.log("URL updated:",o)}else console.error("No PDF URL found for ID:",e),showToast("Sorry, File is not available")}function downloadPDfUrl(e){if(!pdfData[e]){console.error("Invalid fileId or pdfData not defined.");return}let t=pdfData[e].url.replace("/preview","/edit");t?(console.log("Opening modified PDF URL in a new tab:",t),window.open(t,"_blank")):console.error("Failed to modify PDF URL.")}function closePDF(){let e=document.getElementById("pdfOverlay"),t=document.getElementById("pdfIframe"),a=document.body;e&&t&&(e.style.display="none",t.src="",a&&(a.style.overflow="visible",console.log("close pdf")));let n=new URLSearchParams(window.location.search);n.delete("pdf");let l=`${window.location.origin+window.location.pathname}?${n.toString()}`;window.history.pushState({path:l},"",l)}function showToast(e){let t=document.getElementById("toast-container");if(!t){console.error("Toast container not found!");return}let a=document.createElement("div");a.classList.add("toast");let n=document.createElement("span");n.classList.add("toast-message"),n.textContent=e;let l=document.createElement("div");l.classList.add("progress-bar");let s=document.createElement("div");s.classList.add("progress-bar-fill"),l.appendChild(s),a.appendChild(n),a.appendChild(l),t.appendChild(a),a.classList.add("show");let o=0,r=setInterval(()=>{o+=1,s.style.width=`${o}%`,o>=100&&(clearInterval(r),a.classList.remove("show"),setTimeout(()=>{t.removeChild(a)},300))},30)}function filterCards(){let e=document.querySelector(".search-bar"),t=document.getElementById("filterOptions"),a=document.getElementById("cardContainer"),n=document.getElementById("cardCount");if(!e||!t||!a||!n){console.error("Search input, filter select, or card container not found!");return}let l=e.value.toLowerCase(),s=t.value,o=a.getElementsByClassName("card"),r=0;Array.from(o).forEach(e=>{let t=e.querySelector("h2").textContent.toLowerCase(),a=e.getAttribute("data-category");t.includes(l)&&("all"===s||a===s)?(e.style.display="block",r++):e.style.display="none"}),n.innerHTML=` Results: ${r}`;let i=document.querySelector(".sort-container-main"),d=document.querySelector("#results"),c=d.querySelector("#no-results-message");0===r?c&&(c.style.display="block",d.style.display="block",i.style.display="none"):c&&(c.style.display="none",d.style.display="none",i.style.display="block")}function lazyLoadInstance(){let e=document.querySelectorAll(".lazy-load"),t=new IntersectionObserver((e,t)=>{e.forEach(e=>{if(e.isIntersecting){let a=e.target;a.src=a.dataset.src,a.classList.remove("lazy-load"),t.unobserve(a)}})});e.forEach(e=>{t.observe(e)})}document.addEventListener("DOMContentLoaded",function(){shuffleCards()}),document.addEventListener("DOMContentLoaded",function(){let e=document.getElementById("mainFilterOptions"),t=document.getElementById("filterOptions"),a=document.getElementById("resetButton"),n=document.querySelectorAll(".card"),l={frontend:[{value:"html",text:"HTML & CSS"},{value:"javascript",text:"JavaScript"},{value:"react",text:"React JS"},{value:"angular",text:"Angular"}],backend:[{value:"Nodejs",text:"Node.js"},{value:"java",text:"Java"},{value:"python",text:"Python"}],database:[{value:"sql",text:"SQL"},{value:"mongodb",text:"MongoDB"},{value:"firebase",text:"Firebase"}],devops:[{value:"docker",text:"Docker"},{value:"kubernetes",text:"Kubernetes"},{value:"jenkins",text:"Jenkins"}],other:[{value:"dsa",text:"DSA"},{value:"git",text:"Git"},{value:"bash",text:"Bash"},{value:"sysdesign",text:"System Design"},{value:"testing",text:"Testing"},]};function s(e,t){let a=window.location.origin+window.location.pathname,n,l=`${a}?category=${encodeURIComponent(e)}&subcategory=${encodeURIComponent(t)}`;return window.history.pushState({path:l},"",l),console.log(l),l}e.addEventListener("change",function(){let e=this.value;if(n.forEach(t=>{"select"===e||t.getAttribute("data-category")===e?t.style.display="block":t.style.display="none"}),t.innerHTML='<option value="all">Select Technology</option>',l[e]){l[e].forEach(e=>{let a=document.createElement("option");a.value=e.value,a.text=e.text,t.appendChild(a)}),t.style.display="inline-block",a.style.display="inline-block",console.error(e),s("category",e);return}t.style.display="none",a.style.display="none",filterCards()}),t.addEventListener("change",function(){var e;let t=this.value,a;console.log(t),n.forEach(e=>{"all"===t||e.getAttribute("data-subcategory")===t?e.style.display="block":e.style.display="none"}),e=t,console.log(e+" selected"),(a=document.querySelector(".resultsCategory"))?a.innerHTML=e:console.error('Element with class "resultsCategory" not found!'),s("subcategory",t)}),a.addEventListener("click",function(){e.value="select",t.innerHTML='<option value="all">Select Technology</option>',t.style.display="none",a.style.display="none",n.forEach(e=>{e.style.display="block"});let l=window.location.origin+window.location.pathname;window.history.pushState({path:l},"",l),location.reload(!0),clearLocalStorageData(),window.checkLikedCards("likedCards","liked")})}),document.addEventListener("DOMContentLoaded",function(){let e=document.getElementById("sortOptions"),t=document.getElementById("cardContainer");e.addEventListener("change",function(){let e=this.value,a;switch(e){case"titleAsc":a=Object.entries(pdfData).sort((e,t)=>e[1].title.localeCompare(t[1].title));break;case"titleDesc":a=Object.entries(pdfData).sort((e,t)=>t[1].title.localeCompare(e[1].title));break;case"newest":a=Object.entries(pdfData).sort((e,t)=>new Date(t[1].date)-new Date(e[1].date));break;case"popular":a=Object.entries(pdfData).sort((e,t)=>t[1].popularity-e[1].popularity);break;default:a=Object.entries(pdfData)}t.innerHTML="",a.forEach(([e,a])=>{let n=createCard(e,a);t.appendChild(n)}),lazyLoadInstance(),filterCards(),imageLoadOnCategory(),populateCards(),console.log("Cards sorted by:",e)})}),document.addEventListener("DOMContentLoaded",()=>{populateCards(),document.querySelector(".search-bar")?.addEventListener("input",filterCards),document.getElementById("filterOptions")?.addEventListener("change",filterCards),document.getElementById("loadMoreBtn")?.addEventListener("click",()=>{currentPage++,showCards()})}),document.addEventListener("DOMContentLoaded",function(){let e=document.getElementById("searchInput"),t=document.getElementById("filterSelect"),a=document.getElementById("cardContainer"),n=document.createElement("p");function l(){var l;let s=e.value.toLowerCase(),o=t.value,r=a.getElementsByClassName("card"),i=0;for(let d of r){let c=d.textContent.toLowerCase(),p=d.getAttribute("data-category"),u=c.includes(s),g="all"===o||p===o;u&&g?(d.style.display="block",i++):d.style.display="none"}l=i,n.textContent=`Results : ${l}`}n.id="resultsCount",t.parentNode.insertBefore(n,a),e.addEventListener("input",l),t.addEventListener("change",l),l()}),document.addEventListener("DOMContentLoaded",function(){let e=document.querySelector(".search-bar"),t=document.getElementById("filterOptions"),a=document.getElementById("cardContainer"),n=document.getElementById("cardCount");function l(){var l;let s=e.value.toLowerCase(),o=t.value,r=a.getElementsByClassName("card"),i=0;for(let d of r){let c=d.textContent.toLowerCase(),p=d.getAttribute("data-category"),u=c.includes(s),g="all"===o||p===o;u&&g?(d.style.display="block",i++):d.style.display="none"}l=i,n.textContent=` Results : ${l}`}e.addEventListener("input",l),t.addEventListener("change",l),l()}),document.querySelectorAll(".main-filter-options, .filter-options").forEach(e=>{e.addEventListener("click",function(){this.classList.toggle("open")})}),document.addEventListener("DOMContentLoaded",()=>{let e=new Set(JSON.parse(localStorage.getItem("likedCards"))||[]),t=()=>{document.querySelectorAll(".card").forEach(t=>{let a=t.getAttribute("data-id"),n=t.querySelector(".like-btn");e.has(a)?n.classList.add("liked"):n.classList.remove("liked")})},a=a=>{let n=a.closest(".card").getAttribute("data-id");if(e.has(n))e.delete(n);else{if(e.size>=10){showToast("You can have reached the maximum number of likes");return}e.add(n)}localStorage.setItem("likedCards",JSON.stringify([...e])),t()};window.addEventListener("load",function(){let e=(e,t)=>{let a=JSON.parse(localStorage.getItem(e))||[];document.querySelectorAll("[data-id]").forEach(e=>{let n=e.getAttribute("data-id");a.includes(n)&&(e.classList.add(t),console("likes add"))})};t(),window.checkLikedCards=e}),document.body.addEventListener("click",e=>{e.target.classList.contains("like-btn")&&a(e.target)})});let loadedCards=0;const totalCards=Object.keys(pdfData).length,cardContainer=document.getElementById("cardContainer"),preloaderContainer=document.getElementById("preloader-container");function loadMoreCards(){let e=Math.min(loadedCards+(window.innerWidth<=768?6:12),totalCards);for(let t=loadedCards;t<e;t++){let a=createCard(t,pdfData[t]),n=a.querySelector(".view-btn"),l=a.querySelector(".Download-pdf-btn");n&&n.addEventListener("click",e=>{e.stopPropagation(),openPDF(t)}),l&&l.addEventListener("click",e=>{e.stopPropagation(),downloadPDfUrl(t)}),cardContainer.appendChild(a)}(loadedCards=e)>=totalCards&&(window.removeEventListener("scroll",handleScroll),preloaderContainer.style.display="none")}function handleScroll(){let e;window.scrollY+window.innerHeight>=document.documentElement.scrollHeight-200&&loadedCards<totalCards&&(preloaderContainer.style.display="block",loadMoreCards())}document.addEventListener("DOMContentLoaded",()=>{loadMoreCards(),window.addEventListener("scroll",handleScroll)});const scrollToTopBtn=document.getElementById("scrollToTopBtn");function showLoginOverlay(){if(!document.getElementById("loginOverlayParent")){let e=document.createElement("div");e.id="loginOverlayParent",e.className="overlay-parent",e.innerHTML=`
        <div class="overlay">
        <button class="close-btn" onclick="closeLoginOverlay()">
            <i class="fa fa-window-close" aria-hidden="true"></i>
        </button>
        <div class="overlay-content">
            <form id="loginForm" class="login-form" onsubmit="validateLogin(event)">
                <h2>Login</h2>
                <div class="input-group">
                    <i class="fa fa-user input-icon"></i>
                    <input type="text" id="username" placeholder="Username or Email" required />
                </div>
                <div class="input-group">
                    <i class="fa fa-lock input-icon"></i>
                    <input type="password" id="password" placeholder="Password" required />
                </div>
                <p id="loginErrorMessage" class="error-msg hidden">Invalid username or password. Please try again.</p>
                <button type="submit" class="btn-primary">Login</button>
            </form>
        </div>
    </div>
        `,document.body.appendChild(e),setTimeout(()=>e.classList.add("visible"),10)}}window.addEventListener("scroll",()=>{window.scrollY>300?scrollToTopBtn.style.display="block":scrollToTopBtn.style.display="none"}),scrollToTopBtn.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})});const apiKeyLogin="$2a$10$usr7CFwnNJEbmm9wmLSiY.Sb5okVepyvx6vbKma7qdBPp5MLqVChi",binId="6770f510ad19ca34f8e27334",apiUrl="https://api.jsonbin.io/v3/b/6770f510ad19ca34f8e27334/latest";function fetchUserData(){fetch("https://api.jsonbin.io/v3/b/6770f510ad19ca34f8e27334/latest",{method:"GET",headers:{"X-Master-Key":"$2a$10$usr7CFwnNJEbmm9wmLSiY.Sb5okVepyvx6vbKma7qdBPp5MLqVChi"}}).then(e=>{if(!e.ok)throw Error("Failed to fetch user data.");return e.json()}).then(e=>{localStorage.setItem("users",JSON.stringify(e.record.users))}).catch(e=>{console.error("Error fetching user data:",e)})}function validateLogin(e){e.preventDefault();let t=document.getElementById("username").value.trim(),a=document.getElementById("password").value.trim(),n=document.getElementById("loginErrorMessage");if(!t||!a){n.textContent="Please enter both username and password.",n.classList.remove("hidden");return}let l=JSON.parse(localStorage.getItem("users"));if(l){let s=l.find(e=>(e.username===t||e.email===t)&&e.password===a);s?(alert("Login successful!"),closeLoginOverlay()):(n.textContent="Invalid username or password. Please try again.",n.classList.remove("hidden"))}else n.textContent="No user data found. Please refresh the page.",n.classList.remove("hidden")}function closeLoginOverlay(){let e=document.getElementById("loginOverlayParent");e&&(e.classList.remove("visible"),setTimeout(()=>e.remove(),300))}function openLoginOverlay(){let e=document.getElementById("loginOverlayParent");e.classList.add("active")}window.onload=e=>{fetchUserData(e)};